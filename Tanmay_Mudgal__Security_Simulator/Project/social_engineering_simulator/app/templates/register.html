{% extends "base.html" %}

{% block title %}Register - SE Simulator{% endblock %}

{% block main_wrapper %}
<!-- Full Width Layout Override -->
<div class="landing-page">

    <!-- Hero Section -->
    <section class="landing-hero">
        <!-- Background Elements -->
        <div class="hero-bg-anim"></div>
        <div class="cyber-grid"></div>
        <div class="data-node node-1"></div>
        <div class="data-node node-2"></div>

        <div class="hero-content">
            <h1 class="hero-title">
                Start Your <br>
                <span class="typing-effect"
                    style="color: var(--accent-green); border-color: var(--accent-green);">Security Journey</span>
            </h1>
            <p class="hero-subtitle">
                Join thousands of security professionals mastering the human defense layer.
                Get instant access to realistic scenarios and training modules.
            </p>

            <div style="display: flex; gap: 3rem; margin-top: 3rem; flex-wrap: wrap; justify-content: flex-start;">
                <div style="text-align: left;">
                    <div style="font-size: 2.2rem; font-weight: 800; color: white; line-height: 1;">10+</div>
                    <div style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.25rem;">Training Modules
                    </div>
                </div>
                <div style="text-align: left;">
                    <div style="font-size: 2.2rem; font-weight: 800; color: white; line-height: 1;">50+</div>
                    <div style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.25rem;">Scenario
                        Templates</div>
                </div>
                <div style="text-align: left;">
                    <div style="font-size: 2.2rem; font-weight: 800; color: white; line-height: 1;">Global</div>
                    <div style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.25rem;">Leaderboards
                    </div>
                </div>
            </div>
        </div>

        <div class="hero-visuals">
            <div class="login-wrapper">
                <style>
                    /* Local overrides to fit the card in the hero */
                    .auth-box {
                        background: rgba(15, 23, 42, 0.8);
                        backdrop-filter: blur(20px);
                        border: 1px solid rgba(255, 255, 255, 0.1);
                        max-width: 100%;
                    }
                </style>

                <div class="auth-box">
                    <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 2rem;">
                        <span style="font-size: 2.5rem; margin-right: 10px;">ðŸ‘‹</span>
                        <h2 style="margin:0; font-size: 1.8rem;">Create Account</h2>
                    </div>

                    <!-- Type Toggle -->
                    <div class="type-toggle">
                        <button type="button" class="toggle-option active" onclick="setAccountType('Individual')"
                            id="btn-individual">Individual</button>
                        <button type="button" class="toggle-option" onclick="setAccountType('Enterprise')"
                            id="btn-enterprise">Enterprise</button>
                    </div>

                    <form method="POST" class="auth-form">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                        <input type="hidden" id="account_type" name="account_type" value="Individual">

                        <div class="form-group" id="org-group" style="display: none;">
                            <label for="organization">Organization Name</label>
                            <input type="text" id="organization" name="organization"
                                placeholder="Enter your organization">
                        </div>

                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" name="email" required placeholder="name@example.com">
                        </div>

                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" name="username" required minlength="3"
                                placeholder="Choose a username">
                        </div>

                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" name="password" required
                                placeholder="Create a strong password">

                            <!-- Password Strength Checklist -->
                            <div class="password-checklist">
                                <div class="checklist-item" id="check-length">
                                    <span class="icon">âšª</span> 8+ Characters
                                </div>
                                <div class="checklist-item" id="check-uppercase">
                                    <span class="icon">âšª</span> Uppercase Letter
                                </div>
                                <div class="checklist-item" id="check-number">
                                    <span class="icon">âšª</span> Number
                                </div>
                                <div class="checklist-item" id="check-special">
                                    <span class="icon">âšª</span> Special Char (!@#$%)
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary"
                            style="margin-top: 1rem; background: var(--accent-green); color: #000;">
                            Initialize Account
                        </button>
                    </form>

                    <style>
                        .password-checklist {
                            margin-top: 10px;
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 8px;
                            font-size: 0.85rem;
                        }

                        .checklist-item {
                            display: flex;
                            align-items: center;
                            color: rgba(255, 255, 255, 0.5);
                            transition: all 0.3s ease;
                        }

                        .checklist-item.valid {
                            color: var(--accent-green);
                        }

                        .checklist-item.valid .icon {
                            content: "âœ…";
                        }

                        .checklist-item .icon {
                            margin-right: 6px;
                            font-size: 0.8rem;
                        }
                    </style>

                    <script>
                        document.addEventListener('DOMContentLoaded', function () {
                            const passwordInput = document.getElementById('password');
                            const checks = {
                                length: { id: 'check-length', regex: /.{8,}/ },
                                uppercase: { id: 'check-uppercase', regex: /[A-Z]/ },
                                number: { id: 'check-number', regex: /[0-9]/ },
                                special: { id: 'check-special', regex: /[!@#$%^&*(),.?":{}|<>]/ }
                            };

                            if (passwordInput) {
                                passwordInput.addEventListener('input', function () {
                                    const val = this.value;

                                    for (const key in checks) {
                                        const item = document.getElementById(checks[key].id);
                                        const isValid = checks[key].regex.test(val);
                                        const icon = item.querySelector('.icon');

                                        if (isValid) {
                                            item.classList.add('valid');
                                            icon.textContent = 'âœ…';
                                        } else {
                                            item.classList.remove('valid');
                                            icon.textContent = 'âšª';
                                        }
                                    }
                                });
                            }
                        });
                    </script>

                    <p class="auth-link">Already recruited? <a href="{{ url_for('main.login') }}">Access Terminal</a>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Threat Ticker -->
    <div class="ticker-wrap">
        <div class="ticker">
            <!-- Set 1 -->
            <div class="ticker-item"><strong>THREAT INTEL:</strong> ONLINE</div>
            <div class="ticker-item"><strong>FACT:</strong> 98% OF CYBER ATTACKS RELY on SOCIAL ENGINEERING</div>
            <div class="ticker-item"><strong>AVG BREACH COST:</strong> $4.45 MILLION</div>
            <div class="ticker-item"><strong>GLOBAL PHISHING:</strong> UP 47% YOY</div>
            <div class="ticker-item"><strong>HUMAN ERROR:</strong> CAUSES 82% OF BREACHES</div>
            <div class="ticker-item"><strong>ALERT:</strong> NEW AI VISHING VECTORS DETECTED</div>
            <!-- Set 2 (Duplicate for smooth loop) -->
            <div class="ticker-item"><strong>THREAT INTEL:</strong> ONLINE</div>
            <div class="ticker-item"><strong>FACT:</strong> 98% OF CYBER ATTACKS RELY on SOCIAL ENGINEERING</div>
            <div class="ticker-item"><strong>AVG BREACH COST:</strong> $4.45 MILLION</div>
            <div class="ticker-item"><strong>GLOBAL PHISHING:</strong> UP 47% YOY</div>
            <div class="ticker-item"><strong>HUMAN ERROR:</strong> CAUSES 82% OF BREACHES</div>
            <div class="ticker-item"><strong>ALERT:</strong> NEW AI VISHING VECTORS DETECTED</div>
        </div>
    </div>
</div>

<script>
    function setAccountType(type) {
        document.getElementById('account_type').value = type;
        const btnInd = document.getElementById('btn-individual');
        const btnEnt = document.getElementById('btn-enterprise');
        const orgGroup = document.getElementById('org-group');

        if (type === 'Individual') {
            btnInd.classList.add('active');
            btnEnt.classList.remove('active');
            orgGroup.style.display = 'none';
            document.getElementById('organization').required = false;
        } else {
            btnEnt.classList.add('active');
            btnInd.classList.remove('active');
            orgGroup.style.display = 'block';
            document.getElementById('organization').required = true;

            // Animation for org field appearing
            orgGroup.style.opacity = '0';
            orgGroup.style.transform = 'translateY(-10px)';
            setTimeout(() => {
                orgGroup.style.transition = 'all 0.3s ease';
                orgGroup.style.opacity = '1';
                orgGroup.style.transform = 'translateY(0)';
            }, 10);
        }
    }
</script>
{% endblock %}
{% block content %}{% endblock %}